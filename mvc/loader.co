fs = require \fs
path = require \path
{signal} = require "./signal.co"

class exports.Loader
	done: signal!
	(dir)->
		function down file
			err,stat <- fs.stat path.join dir,file
			throw err if err
			console.log file
			if stat.isDirectory!
				@traverse path.join dir,file
			else
				require path.join dir,file

		err,files <- fs.readdir dir
		throw err if err
		down file for file of files
